{"ast":null,"code":"import _regeneratorRuntime from \"@babel/runtime-corejs2/regenerator\";\nimport _JSON$stringify from \"@babel/runtime-corejs2/core-js/json/stringify\";\nimport _slicedToArray from \"@babel/runtime-corejs2/helpers/esm/slicedToArray\";\nimport _asyncToGenerator from \"@babel/runtime-corejs2/helpers/esm/asyncToGenerator\";\nvar _jsxFileName = \"C:\\\\Users\\\\majed\\\\eclipse-workspace\\\\HopSpot\\\\testingRESTfulAPI\\\\components\\\\FormikForm.js\";\nimport React from \"react\";\nimport Autosuggest from \"react-autosuggest\";\nimport { Formik } from \"formik\";\nimport * as Yup from \"yup\";\nimport axios from \"axios\";\nimport Error from \"./Error\";\nvar ValidationSchema = Yup.object().shape({\n  password: Yup.string().min(1, \"Too Short!\").max(255, \"Too Long!\").required(\"Required\"),\n  country: Yup.string().min(1, \"Too Short!\").max(255, \"Too Long!\").required(\"Required\"),\n  email: Yup.string().email(\"Must be an email address\").max(255, \"Too Long!\").required(\"Required\")\n});\n\nfunction isValidPostalCode(postalCode, country) {\n  var postalCodeRegex;\n\n  switch (country) {\n    case \"United States of America\":\n      postalCodeRegex = /^([0-9]{5})(?:[-\\s]*([0-9]{4}))?$/;\n      break;\n\n    case \"Canada\":\n      postalCodeRegex = /^([A-Z][0-9][A-Z])\\s*([0-9][A-Z][0-9])$/;\n      break;\n\n    default:\n      return true;\n  }\n\n  return postalCodeRegex.test(postalCode);\n}\n\nfunction postalCodeLabel(country) {\n  var postalCodeLabels = {\n    \"United States of America\": \"Zip Code\",\n    Canada: \"Postal Code\"\n  };\n  return postalCodeLabels[country] || \"Postal Code\";\n}\n\nfunction showPostalCode(country) {\n  return [\"United States of America\", \"Canada\"].includes(country);\n}\n\nfunction addUser(_x) {\n  return _addUser.apply(this, arguments);\n}\n\nfunction _addUser() {\n  _addUser = _asyncToGenerator(\n  /*#__PURE__*/\n  _regeneratorRuntime.mark(function _callee2(req) {\n    var res, status;\n    return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n      while (1) {\n        switch (_context2.prev = _context2.next) {\n          case 0:\n            console.log(\"at add user\");\n            _context2.next = 3;\n            return fetch(req);\n\n          case 3:\n            res = _context2.sent;\n            _context2.next = 6;\n            return res.status;\n\n          case 6:\n            status = _context2.sent;\n            console.log('status is: ' + status);\n\n            if (res.status == 201) {\n              this.fetchAll('users');\n            }\n\n          case 9:\n          case \"end\":\n            return _context2.stop();\n        }\n      }\n    }, _callee2, this);\n  }));\n  return _addUser.apply(this, arguments);\n}\n\nfunction fetchAll(_x2) {\n  return _fetchAll.apply(this, arguments);\n}\n\nfunction _fetchAll() {\n  _fetchAll = _asyncToGenerator(\n  /*#__PURE__*/\n  _regeneratorRuntime.mark(function _callee3(route) {\n    var headers, options, req, res, myBlob;\n    return _regeneratorRuntime.wrap(function _callee3$(_context3) {\n      while (1) {\n        switch (_context3.prev = _context3.next) {\n          case 0:\n            console.log(route);\n            console.log('Returned success from server side');\n            headers = new Headers();\n            options = {\n              method: 'GET',\n              headers: headers,\n              mode: 'cors',\n              cache: 'default'\n            };\n            req = new Request('http://localhost:3000/users', options);\n            _context3.next = 7;\n            return fetch(req);\n\n          case 7:\n            res = _context3.sent;\n            _context3.next = 10;\n            return res.status;\n\n          case 10:\n            status = _context3.sent;\n\n            if (status === 200) {\n              console.log('success from all');\n            }\n\n            _context3.next = 14;\n            return res.blob();\n\n          case 14:\n            myBlob = _context3.sent;\n            console.log(myBlob);\n\n          case 16:\n          case \"end\":\n            return _context3.stop();\n        }\n      }\n    }, _callee3);\n  }));\n  return _fetchAll.apply(this, arguments);\n}\n\nexport default function FormikForm() {\n  var _React$useState = React.useState(\"\"),\n      _React$useState2 = _slicedToArray(_React$useState, 2),\n      country = _React$useState2[0],\n      setCountry = _React$useState2[1];\n\n  var _React$useState3 = React.useState([]),\n      _React$useState4 = _slicedToArray(_React$useState3, 2),\n      suggestions = _React$useState4[0],\n      setSuggestions = _React$useState4[1];\n\n  return React.createElement(Formik, {\n    initialValues: {\n      password: \"\",\n      email: \"\",\n      country: \"\",\n      postalCode: \"\"\n    },\n    validationSchema: ValidationSchema,\n    validate: function validate(values) {\n      var errors = {}; // Validate the Postal Code conditionally based on the chosen Country\n\n      if (!isValidPostalCode(values.postalCode, values.country)) {\n        errors.postalCode = \"\".concat(postalCodeLabel(values.country), \" invalid\");\n      }\n\n      return errors;\n    },\n    onSubmit: function onSubmit(values, _ref) {\n      var setSubmitting = _ref.setSubmitting,\n          resetForm = _ref.resetForm;\n      setSubmitting(true); //        setTimeout(() => {\n      //          alert(JSON.stringify(values, null, 2));\n      //          resetForm();\n      //          setCountry(\"\");\n      //          setSubmitting(false);\n      //        }, 500);\n\n      var headers = new Headers();\n      headers.append('Content-type', 'application/json');\n      var options = {\n        method: 'POST',\n        headers: headers,\n        body: _JSON$stringify(values)\n      };\n      var req = new Request('http://localhost:3000/users/signup', options);\n      addUser(req);\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 95\n    },\n    __self: this\n  }, function (_ref2) {\n    var values = _ref2.values,\n        errors = _ref2.errors,\n        touched = _ref2.touched,\n        handleChange = _ref2.handleChange,\n        handleBlur = _ref2.handleBlur,\n        handleSubmit = _ref2.handleSubmit,\n        isSubmitting = _ref2.isSubmitting,\n        setFieldValue = _ref2.setFieldValue;\n    return React.createElement(\"form\", {\n      onSubmit: handleSubmit,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 153\n      },\n      __self: this\n    }, React.createElement(\"h2\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 154\n      },\n      __self: this\n    }, \"A Great Form\"), React.createElement(\"div\", {\n      className: \"input-row\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 156\n      },\n      __self: this\n    }, React.createElement(\"label\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 157\n      },\n      __self: this\n    }, \"password\"), React.createElement(\"input\", {\n      type: \"text\",\n      name: \"password\",\n      onChange: handleChange,\n      onBlur: handleBlur,\n      value: values.password,\n      className: touched.password && errors.password ? \"has-error\" : null,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 158\n      },\n      __self: this\n    }), React.createElement(Error, {\n      touched: touched.password,\n      message: errors.password,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 166\n      },\n      __self: this\n    })), React.createElement(\"div\", {\n      className: \"input-row\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 169\n      },\n      __self: this\n    }, React.createElement(\"label\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 170\n      },\n      __self: this\n    }, \"Email\"), React.createElement(\"input\", {\n      type: \"text\",\n      name: \"email\",\n      onChange: handleChange,\n      onBlur: handleBlur,\n      value: values.email,\n      className: touched.email && errors.email ? \"has-error\" : null,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 171\n      },\n      __self: this\n    }), React.createElement(Error, {\n      touched: touched.email,\n      message: errors.email,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 179\n      },\n      __self: this\n    })), React.createElement(\"div\", {\n      className: \"input-row\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 182\n      },\n      __self: this\n    }, React.createElement(\"label\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 183\n      },\n      __self: this\n    }, \"Country\"), React.createElement(Autosuggest, {\n      suggestions: suggestions,\n      onSuggestionsFetchRequested:\n      /*#__PURE__*/\n      function () {\n        var _ref4 = _asyncToGenerator(\n        /*#__PURE__*/\n        _regeneratorRuntime.mark(function _callee(_ref3) {\n          var value, response;\n          return _regeneratorRuntime.wrap(function _callee$(_context) {\n            while (1) {\n              switch (_context.prev = _context.next) {\n                case 0:\n                  value = _ref3.value;\n\n                  if (value) {\n                    _context.next = 4;\n                    break;\n                  }\n\n                  setSuggestions([]);\n                  return _context.abrupt(\"return\");\n\n                case 4:\n                  _context.prev = 4;\n                  _context.next = 7;\n                  return axios.get(\"https://restcountries.eu/rest/v2/name/\".concat(value));\n\n                case 7:\n                  response = _context.sent;\n                  setSuggestions(response.data.map(function (row) {\n                    return {\n                      name: row.name,\n                      flag: row.flag\n                    };\n                  }));\n                  _context.next = 14;\n                  break;\n\n                case 11:\n                  _context.prev = 11;\n                  _context.t0 = _context[\"catch\"](4);\n                  setSuggestions([]);\n\n                case 14:\n                case \"end\":\n                  return _context.stop();\n              }\n            }\n          }, _callee, null, [[4, 11]]);\n        }));\n\n        return function (_x3) {\n          return _ref4.apply(this, arguments);\n        };\n      }(),\n      onSuggestionsClearRequested: function onSuggestionsClearRequested() {\n        setSuggestions([]);\n      },\n      getSuggestionValue: function getSuggestionValue(suggestion) {\n        return suggestion.name;\n      },\n      renderSuggestion: function renderSuggestion(suggestion) {\n        return React.createElement(\"div\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 212\n          },\n          __self: this\n        }, React.createElement(\"img\", {\n          src: suggestion.flag,\n          alt: suggestion.name,\n          style: {\n            width: \"25px\"\n          },\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 213\n          },\n          __self: this\n        }), suggestion.name);\n      },\n      onSuggestionSelected: function onSuggestionSelected(event, _ref5) {\n        var suggestion = _ref5.suggestion,\n            method = _ref5.method;\n\n        if (method === \"enter\") {\n          event.preventDefault();\n        }\n\n        setCountry(suggestion.name);\n        setFieldValue(\"country\", suggestion.name);\n      },\n      inputProps: {\n        placeholder: \"Search for your country\",\n        autoComplete: \"abcd\",\n        value: country,\n        name: \"country\",\n        onChange: function onChange(_event, _ref6) {\n          var newValue = _ref6.newValue;\n          setCountry(newValue);\n        },\n        className: touched.country && errors.country ? \"has-error\" : null\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 184\n      },\n      __self: this\n    }), React.createElement(Error, {\n      touched: touched.country,\n      message: errors.country,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 240\n      },\n      __self: this\n    })), showPostalCode(values.country) ? React.createElement(\"div\", {\n      className: \"input-row\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 244\n      },\n      __self: this\n    }, React.createElement(\"label\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 245\n      },\n      __self: this\n    }, postalCodeLabel(values.country)), React.createElement(\"input\", {\n      type: \"text\",\n      name: \"postalCode\",\n      onChange: handleChange,\n      onBlur: handleBlur //value={values.postalCode}\n      ,\n      className: touched.postalCode && errors.postalCode ? \"has-error\" : null,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 246\n      },\n      __self: this\n    }), React.createElement(Error, {\n      touched: touched.postalCode,\n      message: errors.postalCode,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 256\n      },\n      __self: this\n    })) : null, React.createElement(\"div\", {\n      className: \"input-row\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 260\n      },\n      __self: this\n    }, React.createElement(\"button\", {\n      type: \"submit\",\n      disabled: isSubmitting,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 261\n      },\n      __self: this\n    }, \"Submit\")));\n  });\n}","map":{"version":3,"sources":["C:\\Users\\majed\\eclipse-workspace\\HopSpot\\testingRESTfulAPI\\components\\FormikForm.js"],"names":["React","Autosuggest","Formik","Yup","axios","Error","ValidationSchema","object","shape","password","string","min","max","required","country","email","isValidPostalCode","postalCode","postalCodeRegex","test","postalCodeLabel","postalCodeLabels","Canada","showPostalCode","includes","addUser","req","console","log","fetch","res","status","fetchAll","route","headers","Headers","options","method","mode","cache","Request","blob","myBlob","FormikForm","useState","setCountry","suggestions","setSuggestions","values","errors","setSubmitting","resetForm","append","body","touched","handleChange","handleBlur","handleSubmit","isSubmitting","setFieldValue","value","get","response","data","map","row","name","flag","suggestion","width","event","preventDefault","placeholder","autoComplete","onChange","_event","newValue","className"],"mappings":";;;;;AAAA,OAAOA,KAAP,MAAkB,OAAlB;AACA,OAAOC,WAAP,MAAwB,mBAAxB;AACA,SAASC,MAAT,QAAuB,QAAvB;AACA,OAAO,KAAKC,GAAZ,MAAqB,KAArB;AACA,OAAOC,KAAP,MAAkB,OAAlB;AACA,OAAOC,KAAP,MAAkB,SAAlB;AAEA,IAAMC,gBAAgB,GAAGH,GAAG,CAACI,MAAJ,GAAaC,KAAb,CAAmB;AAC1CC,EAAAA,QAAQ,EAAEN,GAAG,CAACO,MAAJ,GACPC,GADO,CACH,CADG,EACA,YADA,EAEPC,GAFO,CAEH,GAFG,EAEE,WAFF,EAGPC,QAHO,CAGE,UAHF,CADgC;AAK1CC,EAAAA,OAAO,EAAEX,GAAG,CAACO,MAAJ,GACNC,GADM,CACF,CADE,EACC,YADD,EAENC,GAFM,CAEF,GAFE,EAEG,WAFH,EAGNC,QAHM,CAGG,UAHH,CALiC;AAS1CE,EAAAA,KAAK,EAAEZ,GAAG,CAACO,MAAJ,GACJK,KADI,CACE,0BADF,EAEJH,GAFI,CAEA,GAFA,EAEK,WAFL,EAGJC,QAHI,CAGK,UAHL;AATmC,CAAnB,CAAzB;;AAeA,SAASG,iBAAT,CAA2BC,UAA3B,EAAuCH,OAAvC,EAAgD;AAC9C,MAAII,eAAJ;;AAEA,UAAQJ,OAAR;AACE,SAAK,0BAAL;AACEI,MAAAA,eAAe,GAAG,mCAAlB;AACA;;AACF,SAAK,QAAL;AACEA,MAAAA,eAAe,GAAG,yCAAlB;AACA;;AACF;AACE,aAAO,IAAP;AARJ;;AAUA,SAAOA,eAAe,CAACC,IAAhB,CAAqBF,UAArB,CAAP;AACD;;AAED,SAASG,eAAT,CAAyBN,OAAzB,EAAkC;AAChC,MAAMO,gBAAgB,GAAG;AACvB,gCAA4B,UADL;AAEvBC,IAAAA,MAAM,EAAE;AAFe,GAAzB;AAIA,SAAOD,gBAAgB,CAACP,OAAD,CAAhB,IAA6B,aAApC;AACD;;AAED,SAASS,cAAT,CAAwBT,OAAxB,EAAiC;AAC/B,SAAO,CAAC,0BAAD,EAA6B,QAA7B,EAAuCU,QAAvC,CAAgDV,OAAhD,CAAP;AACD;;SAEcW,O;;;;;;;2BAAf,kBAAuBC,GAAvB;AAAA;AAAA;AAAA;AAAA;AAAA;AACCC,YAAAA,OAAO,CAACC,GAAR,CAAY,aAAZ;AADD;AAAA,mBAGmBC,KAAK,CAACH,GAAD,CAHxB;;AAAA;AAGOI,YAAAA,GAHP;AAAA;AAAA,mBAKsBA,GAAG,CAACC,MAL1B;;AAAA;AAKOA,YAAAA,MALP;AAMCJ,YAAAA,OAAO,CAACC,GAAR,CAAY,gBAAgBG,MAA5B;;AACA,gBAAID,GAAG,CAACC,MAAJ,IAAc,GAAlB,EAAuB;AACtB,mBAAKC,QAAL,CAAc,OAAd;AACA;;AATF;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,G;;;;SAYeA,Q;;;;;;;2BAAf,kBAAwBC,KAAxB;AAAA;AAAA;AAAA;AAAA;AAAA;AAECN,YAAAA,OAAO,CAACC,GAAR,CAAYK,KAAZ;AACEN,YAAAA,OAAO,CAACC,GAAR,CAAY,mCAAZ;AAEIM,YAAAA,OALP,GAKiB,IAAIC,OAAJ,EALjB;AAOUC,YAAAA,OAPV,GAOoB;AACfC,cAAAA,MAAM,EAAE,KADO;AAEfH,cAAAA,OAAO,EAAEA,OAFM;AAGfI,cAAAA,IAAI,EAAE,MAHS;AAIfC,cAAAA,KAAK,EAAE;AAJQ,aAPpB;AAcUb,YAAAA,GAdV,GAcgB,IAAIc,OAAJ,CAAY,6BAAZ,EAA2CJ,OAA3C,CAdhB;AAAA;AAAA,mBAgBsBP,KAAK,CAACH,GAAD,CAhB3B;;AAAA;AAgBUI,YAAAA,GAhBV;AAAA;AAAA,mBAiBkBA,GAAG,CAACC,MAjBtB;;AAAA;AAiBGA,YAAAA,MAjBH;;AAmBG,gBAAGA,MAAM,KAAK,GAAd,EAAmB;AAClBJ,cAAAA,OAAO,CAACC,GAAR,CAAY,kBAAZ;AACA;;AArBJ;AAAA,mBAuByBE,GAAG,CAACW,IAAJ,EAvBzB;;AAAA;AAuBUC,YAAAA,MAvBV;AAwBIf,YAAAA,OAAO,CAACC,GAAR,CAAYc,MAAZ;;AAxBJ;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,G;;;;AA2BA,eAAe,SAASC,UAAT,GAAsB;AAAA,wBACL3C,KAAK,CAAC4C,QAAN,CAAe,EAAf,CADK;AAAA;AAAA,MAC5B9B,OAD4B;AAAA,MACnB+B,UADmB;;AAAA,yBAEG7C,KAAK,CAAC4C,QAAN,CAAe,EAAf,CAFH;AAAA;AAAA,MAE5BE,WAF4B;AAAA,MAEfC,cAFe;;AAInC,SACE,oBAAC,MAAD;AACE,IAAA,aAAa,EAAE;AACbtC,MAAAA,QAAQ,EAAE,EADG;AAEbM,MAAAA,KAAK,EAAE,EAFM;AAGbD,MAAAA,OAAO,EAAE,EAHI;AAIbG,MAAAA,UAAU,EAAE;AAJC,KADjB;AAOE,IAAA,gBAAgB,EAAEX,gBAPpB;AAQE,IAAA,QAAQ,EAAE,kBAAA0C,MAAM,EAAI;AAClB,UAAIC,MAAM,GAAG,EAAb,CADkB,CAGlB;;AACA,UAAI,CAACjC,iBAAiB,CAACgC,MAAM,CAAC/B,UAAR,EAAoB+B,MAAM,CAAClC,OAA3B,CAAtB,EAA2D;AACzDmC,QAAAA,MAAM,CAAChC,UAAP,aAAuBG,eAAe,CAAC4B,MAAM,CAAClC,OAAR,CAAtC;AACD;;AAED,aAAOmC,MAAP;AACD,KAjBH;AAkBE,IAAA,QAAQ,EAAE,kBAACD,MAAD,QAA0C;AAAA,UAA/BE,aAA+B,QAA/BA,aAA+B;AAAA,UAAhBC,SAAgB,QAAhBA,SAAgB;AAClDD,MAAAA,aAAa,CAAC,IAAD,CAAb,CADkD,CAG1D;AACA;AACA;AACA;AACA;AACA;;AAEQ,UAAMhB,OAAO,GAAG,IAAIC,OAAJ,EAAhB;AACAD,MAAAA,OAAO,CAACkB,MAAR,CAAe,cAAf,EAA+B,kBAA/B;AAEA,UAAMhB,OAAO,GAAG;AACfC,QAAAA,MAAM,EAAE,MADO;AAEfH,QAAAA,OAAO,EAAPA,OAFe;AAGfmB,QAAAA,IAAI,EAAE,gBAAeL,MAAf;AAHS,OAAhB;AAMA,UAAMtB,GAAG,GAAG,IAAIc,OAAJ,CAAY,oCAAZ,EAAkDJ,OAAlD,CAAZ;AAEAX,MAAAA,OAAO,CAACC,GAAD,CAAP;AAID,KA3CH;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KA6CG;AAAA,QACCsB,MADD,SACCA,MADD;AAAA,QAECC,MAFD,SAECA,MAFD;AAAA,QAGCK,OAHD,SAGCA,OAHD;AAAA,QAICC,YAJD,SAICA,YAJD;AAAA,QAKCC,UALD,SAKCA,UALD;AAAA,QAMCC,YAND,SAMCA,YAND;AAAA,QAOCC,YAPD,SAOCA,YAPD;AAAA,QAQCC,aARD,SAQCA,aARD;AAAA,WAaC;AAAM,MAAA,QAAQ,EAAEF,YAAhB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,sBADF,EAGE;AAAK,MAAA,SAAS,EAAC,WAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBADF,EAEE;AACE,MAAA,IAAI,EAAC,MADP;AAEE,MAAA,IAAI,EAAC,UAFP;AAGE,MAAA,QAAQ,EAAEF,YAHZ;AAIE,MAAA,MAAM,EAAEC,UAJV;AAKE,MAAA,KAAK,EAAER,MAAM,CAACvC,QALhB;AAME,MAAA,SAAS,EAAE6C,OAAO,CAAC7C,QAAR,IAAoBwC,MAAM,CAACxC,QAA3B,GAAsC,WAAtC,GAAoD,IANjE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MAFF,EAUE,oBAAC,KAAD;AAAO,MAAA,OAAO,EAAE6C,OAAO,CAAC7C,QAAxB;AAAkC,MAAA,OAAO,EAAEwC,MAAM,CAACxC,QAAlD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MAVF,CAHF,EAgBE;AAAK,MAAA,SAAS,EAAC,WAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,eADF,EAEE;AACE,MAAA,IAAI,EAAC,MADP;AAEE,MAAA,IAAI,EAAC,OAFP;AAGE,MAAA,QAAQ,EAAE8C,YAHZ;AAIE,MAAA,MAAM,EAAEC,UAJV;AAKE,MAAA,KAAK,EAAER,MAAM,CAACjC,KALhB;AAME,MAAA,SAAS,EAAEuC,OAAO,CAACvC,KAAR,IAAiBkC,MAAM,CAAClC,KAAxB,GAAgC,WAAhC,GAA8C,IAN3D;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MAFF,EAUE,oBAAC,KAAD;AAAO,MAAA,OAAO,EAAEuC,OAAO,CAACvC,KAAxB;AAA+B,MAAA,OAAO,EAAEkC,MAAM,CAAClC,KAA/C;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MAVF,CAhBF,EA6BE;AAAK,MAAA,SAAS,EAAC,WAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,iBADF,EAEE,oBAAC,WAAD;AACE,MAAA,WAAW,EAAE+B,WADf;AAEE,MAAA,2BAA2B;AAAA;AAAA;AAAA;AAAA;AAAA,iCAAE;AAAA;AAAA;AAAA;AAAA;AAAA;AAASc,kBAAAA,KAAT,SAASA,KAAT;;AAAA,sBACtBA,KADsB;AAAA;AAAA;AAAA;;AAEzBb,kBAAAA,cAAc,CAAC,EAAD,CAAd;AAFyB;;AAAA;AAAA;AAAA;AAAA,yBAOF3C,KAAK,CAACyD,GAAN,iDACoBD,KADpB,EAPE;;AAAA;AAOnBE,kBAAAA,QAPmB;AAWzBf,kBAAAA,cAAc,CACZe,QAAQ,CAACC,IAAT,CAAcC,GAAd,CAAkB,UAAAC,GAAG;AAAA,2BAAK;AACxBC,sBAAAA,IAAI,EAAED,GAAG,CAACC,IADc;AAExBC,sBAAAA,IAAI,EAAEF,GAAG,CAACE;AAFc,qBAAL;AAAA,mBAArB,CADY,CAAd;AAXyB;AAAA;;AAAA;AAAA;AAAA;AAkBzBpB,kBAAAA,cAAc,CAAC,EAAD,CAAd;;AAlByB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SAAF;;AAAA;AAAA;AAAA;AAAA,SAF7B;AAuBE,MAAA,2BAA2B,EAAE,uCAAM;AACjCA,QAAAA,cAAc,CAAC,EAAD,CAAd;AACD,OAzBH;AA0BE,MAAA,kBAAkB,EAAE,4BAAAqB,UAAU;AAAA,eAAIA,UAAU,CAACF,IAAf;AAAA,OA1BhC;AA2BE,MAAA,gBAAgB,EAAE,0BAAAE,UAAU;AAAA,eAC1B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,WACE;AACE,UAAA,GAAG,EAAEA,UAAU,CAACD,IADlB;AAEE,UAAA,GAAG,EAAEC,UAAU,CAACF,IAFlB;AAGE,UAAA,KAAK,EAAE;AAAEG,YAAAA,KAAK,EAAE;AAAT,WAHT;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,UADF,EAMGD,UAAU,CAACF,IANd,CAD0B;AAAA,OA3B9B;AAqCE,MAAA,oBAAoB,EAAE,8BAACI,KAAD,SAAmC;AAAA,YAAzBF,UAAyB,SAAzBA,UAAyB;AAAA,YAAb/B,MAAa,SAAbA,MAAa;;AACvD,YAAIA,MAAM,KAAK,OAAf,EAAwB;AACtBiC,UAAAA,KAAK,CAACC,cAAN;AACD;;AACD1B,QAAAA,UAAU,CAACuB,UAAU,CAACF,IAAZ,CAAV;AACAP,QAAAA,aAAa,CAAC,SAAD,EAAYS,UAAU,CAACF,IAAvB,CAAb;AACD,OA3CH;AA4CE,MAAA,UAAU,EAAE;AACVM,QAAAA,WAAW,EAAE,yBADH;AAEVC,QAAAA,YAAY,EAAE,MAFJ;AAGVb,QAAAA,KAAK,EAAE9C,OAHG;AAIVoD,QAAAA,IAAI,EAAE,SAJI;AAKVQ,QAAAA,QAAQ,EAAE,kBAACC,MAAD,SAA0B;AAAA,cAAfC,QAAe,SAAfA,QAAe;AAClC/B,UAAAA,UAAU,CAAC+B,QAAD,CAAV;AACD,SAPS;AAQVC,QAAAA,SAAS,EACPvB,OAAO,CAACxC,OAAR,IAAmBmC,MAAM,CAACnC,OAA1B,GAAoC,WAApC,GAAkD;AAT1C,OA5Cd;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MAFF,EA0DE,oBAAC,KAAD;AAAO,MAAA,OAAO,EAAEwC,OAAO,CAACxC,OAAxB;AAAiC,MAAA,OAAO,EAAEmC,MAAM,CAACnC,OAAjD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MA1DF,CA7BF,EA0FGS,cAAc,CAACyB,MAAM,CAAClC,OAAR,CAAd,GACC;AAAK,MAAA,SAAS,EAAC,WAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OAAQM,eAAe,CAAC4B,MAAM,CAAClC,OAAR,CAAvB,CADF,EAEE;AACE,MAAA,IAAI,EAAC,MADP;AAEE,MAAA,IAAI,EAAC,YAFP;AAGE,MAAA,QAAQ,EAAEyC,YAHZ;AAIE,MAAA,MAAM,EAAEC,UAJV,CAKE;AALF;AAME,MAAA,SAAS,EACPF,OAAO,CAACrC,UAAR,IAAsBgC,MAAM,CAAChC,UAA7B,GAA0C,WAA1C,GAAwD,IAP5D;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MAFF,EAYE,oBAAC,KAAD;AAAO,MAAA,OAAO,EAAEqC,OAAO,CAACrC,UAAxB;AAAoC,MAAA,OAAO,EAAEgC,MAAM,CAAChC,UAApD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MAZF,CADD,GAeG,IAzGN,EA2GE;AAAK,MAAA,SAAS,EAAC,WAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACE;AAAQ,MAAA,IAAI,EAAC,QAAb;AAAsB,MAAA,QAAQ,EAAEyC,YAAhC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,gBADF,CA3GF,CAbD;AAAA,GA7CH,CADF;AA+KD","sourcesContent":["import React from \"react\";\r\nimport Autosuggest from \"react-autosuggest\";\r\nimport { Formik } from \"formik\";\r\nimport * as Yup from \"yup\";\r\nimport axios from \"axios\";\r\nimport Error from \"./Error\";\r\n\r\nconst ValidationSchema = Yup.object().shape({\r\n  password: Yup.string()\r\n    .min(1, \"Too Short!\")\r\n    .max(255, \"Too Long!\")\r\n    .required(\"Required\"),\r\n  country: Yup.string()\r\n    .min(1, \"Too Short!\")\r\n    .max(255, \"Too Long!\")\r\n    .required(\"Required\"),\r\n  email: Yup.string()\r\n    .email(\"Must be an email address\")\r\n    .max(255, \"Too Long!\")\r\n    .required(\"Required\")\r\n});\r\n\r\nfunction isValidPostalCode(postalCode, country) {\r\n  let postalCodeRegex;\r\n\r\n  switch (country) {\r\n    case \"United States of America\":\r\n      postalCodeRegex = /^([0-9]{5})(?:[-\\s]*([0-9]{4}))?$/;\r\n      break;\r\n    case \"Canada\":\r\n      postalCodeRegex = /^([A-Z][0-9][A-Z])\\s*([0-9][A-Z][0-9])$/;\r\n      break;\r\n    default:\r\n      return true;\r\n  }\r\n  return postalCodeRegex.test(postalCode);\r\n}\r\n\r\nfunction postalCodeLabel(country) {\r\n  const postalCodeLabels = {\r\n    \"United States of America\": \"Zip Code\",\r\n    Canada: \"Postal Code\"\r\n  };\r\n  return postalCodeLabels[country] || \"Postal Code\";\r\n}\r\n\r\nfunction showPostalCode(country) {\r\n  return [\"United States of America\", \"Canada\"].includes(country);\r\n}\r\n\r\nasync function addUser(req) {\r\n\tconsole.log(\"at add user\");\r\n\t\r\n\tconst res = await fetch(req);\r\n\t\r\n\tconst status = await res.status;\r\n\tconsole.log('status is: ' + status);\r\n\tif (res.status == 201) {\r\n\t\tthis.fetchAll('users');\r\n\t}\r\n}\r\n\r\nasync function fetchAll(route){\r\n\r\n\tconsole.log(route);\t\r\n  \tconsole.log('Returned success from server side');\r\n\r\n\tconst headers = new Headers();\r\n\t\r\n    const options = { \r\n    \tmethod: 'GET',\r\n\t    headers: headers,\r\n\t    mode: 'cors',\r\n\t    cache: 'default'\t\r\n    };\r\n        \r\n    const req = new Request('http://localhost:3000/users', options);\r\n        \r\n    const res = await fetch(req);\r\n  \tstatus = await res.status;\r\n  \t\r\n  \tif(status === 200) {\r\n  \t\tconsole.log('success from all');\r\n  \t}\r\n\r\n    const myBlob = await res.blob();\r\n    console.log(myBlob);\r\n}\r\n\r\nexport default function FormikForm() {\r\n  const [country, setCountry] = React.useState(\"\");\r\n  const [suggestions, setSuggestions] = React.useState([]);\r\n\r\n  return (\r\n    <Formik\r\n      initialValues={{\r\n        password: \"\",\r\n        email: \"\",\r\n        country: \"\",\r\n        postalCode: \"\"\r\n      }}\r\n      validationSchema={ValidationSchema}\r\n      validate={values => {\r\n        let errors = {};\r\n\r\n        // Validate the Postal Code conditionally based on the chosen Country\r\n        if (!isValidPostalCode(values.postalCode, values.country)) {\r\n          errors.postalCode = `${postalCodeLabel(values.country)} invalid`;\r\n        }\r\n\r\n        return errors;\r\n      }}\r\n      onSubmit={(values, { setSubmitting, resetForm }) => {\r\n        setSubmitting(true);\r\n\r\n//        setTimeout(() => {\r\n//          alert(JSON.stringify(values, null, 2));\r\n//          resetForm();\r\n//          setCountry(\"\");\r\n//          setSubmitting(false);\r\n//        }, 500);\r\n        \r\n        const headers = new Headers();\r\n        headers.append('Content-type', 'application/json');\r\n        \r\n        const options = { \r\n        \tmethod: 'POST',\r\n        \theaders,\r\n        \tbody: JSON.stringify(values),\r\n        };\r\n        \r\n        const req = new Request('http://localhost:3000/users/signup', options);\r\n        \r\n        addUser(req);\r\n\r\n        \r\n        \r\n      }}\r\n    >\r\n      {({\r\n        values,\r\n        errors,\r\n        touched,\r\n        handleChange,\r\n        handleBlur,\r\n        handleSubmit,\r\n        isSubmitting,\r\n        setFieldValue\r\n      }) => (\r\n    \t\t  \r\n    \t\t  \r\n    \t\t  \r\n        <form onSubmit={handleSubmit}>\r\n          <h2>A Great Form</h2>\r\n\r\n          <div className=\"input-row\">\r\n            <label>password</label>\r\n            <input\r\n              type=\"text\"\r\n              name=\"password\"\r\n              onChange={handleChange}\r\n              onBlur={handleBlur}\r\n              value={values.password}\r\n              className={touched.password && errors.password ? \"has-error\" : null}\r\n            />\r\n            <Error touched={touched.password} message={errors.password} />\r\n          </div>\r\n\r\n          <div className=\"input-row\">\r\n            <label>Email</label>\r\n            <input\r\n              type=\"text\"\r\n              name=\"email\"\r\n              onChange={handleChange}\r\n              onBlur={handleBlur}\r\n              value={values.email}\r\n              className={touched.email && errors.email ? \"has-error\" : null}\r\n            />\r\n            <Error touched={touched.email} message={errors.email} />\r\n          </div>\r\n\r\n          <div className=\"input-row\">\r\n            <label>Country</label>\r\n            <Autosuggest\r\n              suggestions={suggestions}\r\n              onSuggestionsFetchRequested={async ({ value }) => {\r\n                if (!value) {\r\n                  setSuggestions([]);\r\n                  return;\r\n                }\r\n\r\n                try {\r\n                  const response = await axios.get(\r\n                    `https://restcountries.eu/rest/v2/name/${value}`\r\n                  );\r\n\r\n                  setSuggestions(\r\n                    response.data.map(row => ({\r\n                      name: row.name,\r\n                      flag: row.flag\r\n                    }))\r\n                  );\r\n                } catch (e) {\r\n                  setSuggestions([]);\r\n                }\r\n              }}\r\n              onSuggestionsClearRequested={() => {\r\n                setSuggestions([]);\r\n              }}\r\n              getSuggestionValue={suggestion => suggestion.name}\r\n              renderSuggestion={suggestion => (\r\n                <div>\r\n                  <img\r\n                    src={suggestion.flag}\r\n                    alt={suggestion.name}\r\n                    style={{ width: \"25px\" }}\r\n                  />\r\n                  {suggestion.name}\r\n                </div>\r\n              )}\r\n              onSuggestionSelected={(event, { suggestion, method }) => {\r\n                if (method === \"enter\") {\r\n                  event.preventDefault();\r\n                }\r\n                setCountry(suggestion.name);\r\n                setFieldValue(\"country\", suggestion.name);\r\n              }}\r\n              inputProps={{\r\n                placeholder: \"Search for your country\",\r\n                autoComplete: \"abcd\",\r\n                value: country,\r\n                name: \"country\",\r\n                onChange: (_event, { newValue }) => {\r\n                  setCountry(newValue);\r\n                },\r\n                className:\r\n                  touched.country && errors.country ? \"has-error\" : null\r\n              }}\r\n            />\r\n            <Error touched={touched.country} message={errors.country} />\r\n          </div>\r\n\r\n          {showPostalCode(values.country) ? (\r\n            <div className=\"input-row\">\r\n              <label>{postalCodeLabel(values.country)}</label>\r\n              <input\r\n                type=\"text\"\r\n                name=\"postalCode\"\r\n                onChange={handleChange}\r\n                onBlur={handleBlur}\r\n                //value={values.postalCode}\r\n                className={\r\n                  touched.postalCode && errors.postalCode ? \"has-error\" : null\r\n                }\r\n              />\r\n              <Error touched={touched.postalCode} message={errors.postalCode} />\r\n            </div>\r\n          ) : null}\r\n\r\n          <div className=\"input-row\">\r\n            <button type=\"submit\" disabled={isSubmitting}>\r\n              Submit\r\n            </button>\r\n          </div>\r\n        </form>\r\n      )}\r\n    </Formik>\r\n  );\r\n}"]},"metadata":{},"sourceType":"module"}