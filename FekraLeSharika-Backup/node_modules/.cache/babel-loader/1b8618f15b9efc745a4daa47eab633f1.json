{"ast":null,"code":"import _classCallCheck from \"@babel/runtime-corejs2/helpers/esm/classCallCheck\";\nimport _createClass from \"@babel/runtime-corejs2/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"@babel/runtime-corejs2/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"@babel/runtime-corejs2/helpers/esm/getPrototypeOf\";\nimport _assertThisInitialized from \"@babel/runtime-corejs2/helpers/esm/assertThisInitialized\";\nimport _inherits from \"@babel/runtime-corejs2/helpers/esm/inherits\";\nimport React, { Component } from 'react';\nimport AddressSuggest from './AddressSuggest';\nimport AddressInput from './AddressInput';\nimport axios from 'axios';\nvar APP_ID_HERE = 'APP_ID_HERE';\nvar APP_CODE_HERE = 'APP_CODE_HERE';\n\nvar AddressForm =\n/*#__PURE__*/\nfunction (_Component) {\n  _inherits(AddressForm, _Component);\n\n  function AddressForm(props) {\n    var _this;\n\n    _classCallCheck(this, AddressForm);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(AddressForm).call(this, props));\n    _this.state = _this.getInitialState(); // User has entered something in the address bar\n\n    _this.onQuery = _this.onQuery.bind(_assertThisInitialized(_this)); // User has entered something in an address field\n\n    _this.onAddressChange = _this.onAddressChange.bind(_assertThisInitialized(_this)); // User has clicked the check button\n\n    _this.onCheck = _this.onCheck.bind(_assertThisInitialized(_this)); // User has clicked the clear button\n\n    _this.onClear = _this.onClear.bind(_assertThisInitialized(_this));\n    return _this;\n  }\n\n  _createClass(AddressForm, [{\n    key: \"onQuery\",\n    value: function onQuery(evt) {\n      var query = evt.target.value;\n\n      if (!query.length > 0) {\n        this.setState(this.getInitialState());\n        return;\n      }\n\n      var self = this;\n      axios.get('https://autocomplete.geocoder.api.here.com/6.2/suggest.json', {\n        'params': {\n          'app_id': 928399431916 - o034tjaglvco531va87rpi5jjgn7n6an.apps.googleusercontent.com,\n          'app_code': APP_CODE_HERE,\n          'query': query,\n          'maxresults': 1\n        }\n      }).then(function (response) {\n        if (response.data.suggestions.length > 0) {\n          var id = response.data.suggestions[0].locationId;\n          var address = response.data.suggestions[0].address;\n          self.setState({\n            'address': address,\n            'query': query,\n            'locationId': id\n          });\n        } else {\n          var state = self.getInitialState();\n          self.setState(state);\n        }\n      });\n    }\n  }, {\n    key: \"getInitialState\",\n    value: function getInitialState() {\n      return {\n        'address': {\n          'street': '',\n          'city': '',\n          'state': '',\n          'postalCode': '',\n          'country': ''\n        },\n        'query': '',\n        'locationId': '',\n        'isChecked': false,\n        'coords': {}\n      };\n    }\n  }, {\n    key: \"onClear\",\n    value: function onClear(evt) {\n      var state = this.getInitialState();\n      this.setState(state);\n    }\n  }, {\n    key: \"onAddressChange\",\n    value: function onAddressChange(evt) {\n      var id = evt.target.id;\n      var val = evt.target.value;\n      var state = this.state;\n      state.address[id] = val;\n      this.setState(state);\n    }\n  }, {\n    key: \"onCheck\",\n    value: function onCheck(evt) {\n      var params = {\n        'app_id': APP_ID_HERE,\n        'app_code': APP_CODE_HERE\n      };\n\n      if (this.state.locationId.length > 0) {\n        params['locationId'] = this.state.locationId;\n      } else {\n        params['searchtext'] = this.state.address.street + this.state.address.city + this.state.address.state + this.state.address.postalCode + this.state.address.country;\n      }\n\n      var self = this;\n      axios.get('https://geocoder.api.here.com/6.2/geocode.json', {\n        'params': params\n      }).then(function (response) {\n        var view = response.data.Response.View;\n\n        if (view.length > 0 && view[0].Result.length > 0) {\n          var location = view[0].Result[0].Location;\n          self.setState({\n            'isChecked': 'true',\n            'locationId': '',\n            'query': location.Address.Label,\n            'address': {\n              'street': location.Address.HouseNumber + ' ' + location.Address.Street,\n              'city': location.Address.City,\n              'state': location.Address.State,\n              'postalCode': location.Address.PostalCode,\n              'country': location.Address.Country\n            },\n            'coords': {\n              'lat': location.DisplayPosition.Latitude,\n              'lon': location.DisplayPosition.Longitude\n            }\n          });\n        } else {\n          self.setState();\n        }\n      }).catch(function (error) {\n        console.log('caught failed query');\n        self.setState({\n          'isChecked': true,\n          'coords': null\n        });\n      });\n    }\n  }, {\n    key: \"alert\",\n    value: function alert() {\n      if (!this.state.isChecked) {\n        return;\n      }\n\n      if (this.state.coords === null) {\n        return React.createElement(\"div\", {\n          className: \"alert alert-warning\",\n          role: \"alert\"\n        }, React.createElement(\"b\", null, \"Invalid.\"), \" The address is not recognized.\");\n      } else {\n        return React.createElement(\"div\", {\n          className: \"alert alert-success\",\n          role: \"alert\"\n        }, React.createElement(\"b\", null, \"Valid Address.\"), \"  Location is \", this.state.coords.lat, \", \", this.state.coords.lon, \".\");\n      }\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var result = this.alert();\n      return React.createElement(\"div\", {\n        className: \"container\"\n      }, React.createElement(AddressSuggest, {\n        query: this.state.query,\n        onChange: this.onQuery\n      }), React.createElement(AddressInput, {\n        street: this.state.address.street,\n        city: this.state.address.city,\n        state: this.state.address.state,\n        postalCode: this.state.address.postalCode,\n        country: this.state.address.country,\n        onChange: this.onAddressChange\n      }), React.createElement(\"br\", null), result, React.createElement(\"button\", {\n        type: \"submit\",\n        className: \"btn btn-primary\",\n        onClick: this.onCheck\n      }, \"Check\"), React.createElement(\"button\", {\n        type: \"submit\",\n        className: \"btn btn-outline-secondary\",\n        onClick: this.onClear\n      }, \"Clear\"));\n    }\n  }]);\n\n  return AddressForm;\n}(Component);\n\nexport default AddressForm;","map":null,"metadata":{},"sourceType":"module"}